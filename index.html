ä»•äº‹<!DOCTYPE html>
<html lang="ja">

<head>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2196f3">
<meta charset="UTF-8">
<title>å‡ºå¼µç®¡ç†ã‚¢ãƒ—ãƒª</title>
<body>
<div class="container">
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f5f5f5;
}

.container {
  max-width: 480px;
  margin: 0 auto;
  padding: 12px;
  background: #ffffff;
  min-height: 100vh;
}

h2 {
  margin-top: 16px;
  font-size: 20px;
}

/* å…¥åŠ›ç³»ã¯å…¨éƒ¨æŒ‡ã‚µã‚¤ã‚º */
input, select, button {
  width: 100%;
  font-size: 16px; /* iOSã‚ºãƒ¼ãƒ é˜²æ­¢ */
  padding: 10px;
  margin-bottom: 10px;
  box-sizing: border-box;
}

button {
  background: #2196f3;
  color: white;
  border: none;
  border-radius: 8px;
  font-weight: bold;
}

button:active {
  opacity: 0.7;
}

/* æ—¥ä»˜ç¯„å›² */
.date-range {
  display: flex;
  gap: 8px;
}

.date-range input {
  flex: 1;
}

/* ãƒ†ãƒ¼ãƒ–ãƒ« â†’ ã‚¹ãƒãƒ›ã‚«ãƒ¼ãƒ‰è¡¨ç¤º */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 12px;
}

thead {
  display: none;
}

tr {
  display: block;
  border: 1px solid #ddd;
  border-radius: 8px;
  margin-bottom: 10px;
  padding: 10px;
}

td {
  display: block;
  border: none;
  padding: 4px 0;
  font-size: 14px;
}

/* ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³ */
.action-buttons {
  display: flex;
  gap: 8px;
  margin-top: 8px;
}

.action-buttons button {
  flex: 1;
  font-size: 14px;
  padding: 8px;
}

/* ãã®ä»–å…¥åŠ› */
.hidden {
  display: none;
}
</head>

<h2>å‡ºå¼µå…¥åŠ›</h2>


<input type="date" id="startDate">
ã€œ
<input type="date" id="endDate">

<input type="text" id="client" placeholder="å®¢å…ˆ">

<select id="area">
  <option value="">åœ°æ–¹é¸æŠ</option>
  <option>é–¢æ±</option>
  <option>é–¢è¥¿</option>
  <option>ä¸­éƒ¨</option>
  <option>ä¹å·</option>
</select>

<input type="text" id="product" placeholder="è£½å“">

<select id="content" onchange="toggleOtherInput()">
  <option value="">å†…å®¹é¸æŠ</option>
  <option>æ®ä»˜</option>
  <option>æ”¹é€ </option>
  <option>ä¿®ç†</option>
  <option>ä¿å®ˆ</option>
  <option>ãã®ä»–</option>
</select>

<input type="text" id="otherContent" placeholder="å†…å®¹ã‚’å…¥åŠ›" class="hidden">

<input type="number" id="cost" placeholder="å‡ºå¼µè²»">
<button id="saveBtn" onclick="addTrip()">ä¿å­˜</button>


<h2>å‡ºå¼µä¸€è¦§</h2>
<table>
<thead>
<tr>
<th>æœŸé–“</th>
<th>å®¢å…ˆ</th>
<th>åœ°æ–¹</th>
<th>è£½å“</th>
<th>å†…å®¹</th>
<th>å‡ºå¼µè²»</th>
<th>å‰Šé™¤</th>
</tr>
</thead>
<tbody id="tripList"></tbody>
</table>

<script>
let trips = JSON.parse(localStorage.getItem("trips")) || [];


function saveToStorage() {
  localStorage.setItem("trips", JSON.stringify(trips));
}

function addTrip() {
  const startDate = document.getElementById("startDate").value;
  const endDate = document.getElementById("endDate").value;

  let selectedContent = document.getElementById("content").value;
  const otherContent = document.getElementById("otherContent").value;

  if (selectedContent === "ãã®ä»–") {
    if (!otherContent) {
      alert("ãã®ä»–ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
      return;
    }
    selectedContent = otherContent;
  }

  if (!startDate || !endDate) {
    alert("é–‹å§‹æ—¥ã¨çµ‚äº†æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
    return;
  }

  if (startDate > endDate) {
    alert("çµ‚äº†æ—¥ã¯é–‹å§‹æ—¥ä»¥é™ã«ã—ã¦ãã ã•ã„");
    return;
  }

  const trip = {
    startDate,
    endDate,
    client: document.getElementById("client").value,
    area: document.getElementById("area").value,
    product: document.getElementById("product").value,
    content: selectedContent,
    cost: document.getElementById("cost").value
  };

  if (editIndex === null) {
    // æ–°è¦ä¿å­˜
    trips.push(trip);
  } else {
    // æ›´æ–°
    trips[editIndex] = trip;
    editIndex = null;
  }

  saveToStorage();
  renderTrips();

  // ğŸ”½ ã“ã“ãŒè¶…é‡è¦ï¼ˆå¿…ãšæ¯å›å®Ÿè¡Œã•ã‚Œã‚‹ï¼‰
  document.getElementById("saveBtn").textContent = "ä¿å­˜";

  // ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸåŒ–
  document.querySelectorAll("input").forEach(input => input.value = "");
  document.getElementById("content").value = "";
  document.getElementById("otherContent").classList.add("hidden");
document.body.style.backgroundColor = "";
}


function renderTrips() {
  const list = document.getElementById("tripList");
  list.innerHTML = "";
  trips.forEach((trip, index) => {
    list.innerHTML += `
      <tr>
       <div class="date-range">
  <input type="date" id="startDate">
  <input type="date" id="endDate">
</div>
        <td>${trip.client}</td>
        <td>${trip.area}</td>
        <td>${trip.product}</td>
        <td>${trip.content}</td>
        <td>${trip.cost}</td>
        <td>
  <div class="action-buttons">
    <button onclick="editTrip(${index})">ç·¨é›†</button>
    <button onclick="deleteTrip(${index})">å‰Šé™¤</button>
  </div>
</td>
      </tr>
    `;
  });
}


function toggleOtherInput() {
  const content = document.getElementById("content").value;
  const otherInput = document.getElementById("otherContent");

  if (content === "ãã®ä»–") {
    otherInput.classList.remove("hidden");
  } else {
    otherInput.classList.add("hidden");
    otherInput.value = "";
  }
}

function deleteTrip(index) {
  trips.splice(index, 1);
  saveToStorage();
  renderTrips();
}

let editIndex = null;

function editTrip(index) {
  const trip = trips[index];

  document.getElementById("startDate").value = trip.startDate;
  document.getElementById("endDate").value = trip.endDate;
  document.getElementById("client").value = trip.client;
  document.getElementById("area").value = trip.area;
  document.getElementById("product").value = trip.product;
  document.getElementById("cost").value = trip.cost;

  // å†…å®¹ï¼ˆãã®ä»–å¯¾å¿œï¼‰
  const contentSelect = document.getElementById("content");
  const otherInput = document.getElementById("otherContent");

  const presetContents = ["æ®ä»˜", "æ”¹é€ ", "ä¿®ç†", "ä¿å®ˆ"];

  if (presetContents.includes(trip.content)) {
    contentSelect.value = trip.content;
    otherInput.classList.add("hidden");
    otherInput.value = "";
  } else {
    contentSelect.value = "ãã®ä»–";
    otherInput.classList.remove("hidden");
    otherInput.value = trip.content;
  }

  editIndex = index;
  document.getElementById("saveBtn").textContent = "æ›´æ–°";
document.body.style.backgroundColor = "#fff8dc";

}


</script>
</div>
</body>

</html>

