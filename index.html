ä»•äº‹<!DOCTYPE html>
<html lang="ja">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2196f3">


<head>
<meta charset="UTF-8">
<title>å‡ºå¼µç®¡ç†ã‚¢ãƒ—ãƒª</title>
<style>
body { font-family: Arial; padding: 20px; }
input, select { margin: 5px; padding: 5px; }
button { padding: 5px 10px; }
table { border-collapse: collapse; margin-top: 20px; }
th, td { border: 1px solid #ccc; padding: 8px; }
th { background: #f0f0f0; }
.hidden { display: none; }
</style>
</head>
<body>

<h2>å‡ºå¼µå…¥åŠ›</h2>


<input type="date" id="startDate">
ã€œ
<input type="date" id="endDate">

<input type="text" id="client" placeholder="å®¢å…ˆ">

<select id="area">
  <option value="">åœ°æ–¹é¸æŠ</option>
  <option>é–¢æ±</option>
  <option>é–¢è¥¿</option>
  <option>ä¸­éƒ¨</option>
  <option>ä¹å·</option>
</select>

<input type="text" id="product" placeholder="è£½å“">

<select id="content" onchange="toggleOtherInput()">
  <option value="">å†…å®¹é¸æŠ</option>
  <option>æ®ä»˜</option>
  <option>æ”¹é€ </option>
  <option>ä¿®ç†</option>
  <option>ä¿å®ˆ</option>
  <option>ãã®ä»–</option>
</select>

<input type="text" id="otherContent" placeholder="å†…å®¹ã‚’å…¥åŠ›" class="hidden">

<input type="number" id="cost" placeholder="å‡ºå¼µè²»">
<button id="saveBtn" onclick="addTrip()">ä¿å­˜</button>


<h2>å‡ºå¼µä¸€è¦§</h2>
<table>
<thead>
<tr>
<th>æœŸé–“</th>
<th>å®¢å…ˆ</th>
<th>åœ°æ–¹</th>
<th>è£½å“</th>
<th>å†…å®¹</th>
<th>å‡ºå¼µè²»</th>
<th>å‰Šé™¤</th>
</tr>
</thead>
<tbody id="tripList"></tbody>
</table>

<script>
let trips = JSON.parse(localStorage.getItem("trips")) || [];


function saveToStorage() {
  localStorage.setItem("trips", JSON.stringify(trips));
}

function addTrip() {
  const startDate = document.getElementById("startDate").value;
  const endDate = document.getElementById("endDate").value;

  let selectedContent = document.getElementById("content").value;
  const otherContent = document.getElementById("otherContent").value;

  if (selectedContent === "ãã®ä»–") {
    if (!otherContent) {
      alert("ãã®ä»–ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
      return;
    }
    selectedContent = otherContent;
  }

  if (!startDate || !endDate) {
    alert("é–‹å§‹æ—¥ã¨çµ‚äº†æ—¥ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
    return;
  }

  if (startDate > endDate) {
    alert("çµ‚äº†æ—¥ã¯é–‹å§‹æ—¥ä»¥é™ã«ã—ã¦ãã ã•ã„");
    return;
  }

  const trip = {
    startDate,
    endDate,
    client: document.getElementById("client").value,
    area: document.getElementById("area").value,
    product: document.getElementById("product").value,
    content: selectedContent,
    cost: document.getElementById("cost").value
  };

  if (editIndex === null) {
    // æ–°è¦ä¿å­˜
    trips.push(trip);
  } else {
    // æ›´æ–°
    trips[editIndex] = trip;
    editIndex = null;
  }

  saveToStorage();
  renderTrips();

  // ğŸ”½ ã“ã“ãŒè¶…é‡è¦ï¼ˆå¿…ãšæ¯å›å®Ÿè¡Œã•ã‚Œã‚‹ï¼‰
  document.getElementById("saveBtn").textContent = "ä¿å­˜";

  // ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸåŒ–
  document.querySelectorAll("input").forEach(input => input.value = "");
  document.getElementById("content").value = "";
  document.getElementById("otherContent").classList.add("hidden");
document.body.style.backgroundColor = "";
}


function renderTrips() {
  const list = document.getElementById("tripList");
  list.innerHTML = "";
  trips.forEach((trip, index) => {
    list.innerHTML += `
      <tr>
        <td>${trip.startDate} ã€œ ${trip.endDate}</td>
        <td>${trip.client}</td>
        <td>${trip.area}</td>
        <td>${trip.product}</td>
        <td>${trip.content}</td>
        <td>${trip.cost}</td>
        <td>
          <button onclick="editTrip(${index})">ç·¨é›†</button>
          <button onclick="deleteTrip(${index})">å‰Šé™¤</button>
        </td>
      </tr>
    `;
  });
}


function toggleOtherInput() {
  const content = document.getElementById("content").value;
  const otherInput = document.getElementById("otherContent");

  if (content === "ãã®ä»–") {
    otherInput.classList.remove("hidden");
  } else {
    otherInput.classList.add("hidden");
    otherInput.value = "";
  }
}

function deleteTrip(index) {
  trips.splice(index, 1);
  saveToStorage();
  renderTrips();
}

let editIndex = null;

function editTrip(index) {
  const trip = trips[index];

  document.getElementById("startDate").value = trip.startDate;
  document.getElementById("endDate").value = trip.endDate;
  document.getElementById("client").value = trip.client;
  document.getElementById("area").value = trip.area;
  document.getElementById("product").value = trip.product;
  document.getElementById("cost").value = trip.cost;

  // å†…å®¹ï¼ˆãã®ä»–å¯¾å¿œï¼‰
  const contentSelect = document.getElementById("content");
  const otherInput = document.getElementById("otherContent");

  const presetContents = ["æ®ä»˜", "æ”¹é€ ", "ä¿®ç†", "ä¿å®ˆ"];

  if (presetContents.includes(trip.content)) {
    contentSelect.value = trip.content;
    otherInput.classList.add("hidden");
    otherInput.value = "";
  } else {
    contentSelect.value = "ãã®ä»–";
    otherInput.classList.remove("hidden");
    otherInput.value = trip.content;
  }

  editIndex = index;
  document.getElementById("saveBtn").textContent = "æ›´æ–°";
document.body.style.backgroundColor = "#fff8dc";

}


</script>
</body>
</html>